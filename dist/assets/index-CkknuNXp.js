(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();const o={isConsoleCollapsed:!0,isServerRunning:!1,currentPath:null},e={main:document.getElementById("mainContent"),pathText:document.getElementById("pathText"),console:{wrap:document.getElementById("consoleWrap"),body:document.getElementById("console"),toggle:document.getElementById("consoleToggle"),icon:document.getElementById("toggleIcon"),status:document.getElementById("status")},btn:{select:document.getElementById("selectBtn"),run:document.getElementById("runBtn"),stop:document.getElementById("stopBtn"),consoleStop:document.getElementById("consoleStopBtn"),min:document.getElementById("minBtn"),close:document.getElementById("closeBtn"),github:document.getElementById("githubLink"),support:document.getElementById("supportBtn")}};window.api||(console.error("⚠️ Electron API not available. Please run this app in Electron."),window.api={selectTarget:async()=>({canceled:!0}),startServer:async()=>({success:!1,error:"Electron API not available"}),stopServer:async()=>({success:!1,error:"Electron API not available"}),onServerLog:()=>{},openExternal:()=>{},minimize:()=>{},close:()=>{}});const a={init(){this.bindEvents(),this.log("Localserv ready.")},bindEvents(){e.btn.min.addEventListener("click",()=>window.api.minimize()),e.btn.close.addEventListener("click",()=>window.api.close()),e.btn.github.addEventListener("click",()=>window.api.openExternal("https://github.com/blacnova")),e.btn.support.addEventListener("click",()=>window.api.openExternal("https://blacnova.com")),e.btn.select.addEventListener("click",this.handleSelect.bind(this)),e.btn.run.addEventListener("click",this.handleLaunch.bind(this)),e.btn.stop.addEventListener("click",this.handleStop.bind(this)),e.btn.consoleStop.addEventListener("click",n=>{n.stopPropagation(),this.handleStop()}),e.console.toggle.addEventListener("click",this.toggleConsole.bind(this)),window.api.onServerLog&&window.api.onServerLog((n,t)=>this.log(n,t))},toggleConsole(){o.isConsoleCollapsed=!o.isConsoleCollapsed,o.isConsoleCollapsed?(e.main.classList.remove("hidden"),e.console.wrap.classList.remove("flex-1"),e.console.wrap.classList.add("h-9"),e.console.icon.style.transform="rotate(-90deg)",e.console.body.classList.add("hidden"),e.btn.consoleStop.classList.add("hidden")):(e.main.classList.add("hidden"),e.console.wrap.classList.remove("h-9"),e.console.wrap.classList.add("flex-1"),e.console.icon.style.transform="rotate(0deg)",e.console.body.classList.remove("hidden"),o.isServerRunning&&(e.btn.consoleStop.classList.remove("hidden"),e.btn.consoleStop.classList.add("flex")))},async handleSelect(){const n=await window.api.selectTarget();!n.canceled&&n.filePaths.length>0&&(o.currentPath=n.filePaths[0],e.pathText.textContent=o.currentPath,e.pathText.classList.replace("text-zinc-500","text-zinc-200"),e.btn.run.classList.remove("hidden","flex"),e.btn.run.classList.add("flex"),e.btn.stop.classList.add("hidden"),e.btn.select.innerHTML="Change",e.btn.select.classList.replace("flex-1","w-24"),e.btn.select.classList.remove("flex-1"),this.log(`Target set: ${o.currentPath}`),this.setStatus("READY","blue"))},async handleLaunch(){this.setStatus("STARTING...","yellow"),this.log("Initializing Express engine...");const n=await window.api.startServer(o.currentPath);if(n.success)o.isServerRunning=!0,this.log(`Server active on port ${n.port}`,"success"),this.setStatus("RUNNING","green"),e.btn.run.classList.replace("flex","hidden"),e.btn.stop.classList.replace("hidden","flex"),e.btn.select.disabled=!0,e.btn.select.classList.add("opacity-50","cursor-not-allowed"),o.isConsoleCollapsed||(e.btn.consoleStop.classList.remove("hidden"),e.btn.consoleStop.classList.add("flex"));else{let t=n.error||"An unknown error occurred";t.includes("ENOENT")?t="The selected folder or file could not be found. Please verify the path and try again.":t.includes("EACCES")||t.includes("Permission denied")?t="Access denied. You may need to run Localserv with administrator privileges.":(t.includes("EADDRINUSE")||t.includes("port"))&&(t="The server port is already in use. Please close other applications or try again."),this.log(`Error: ${t}`,"error"),this.setStatus("ERROR","red")}},async handleStop(){this.log("Stopping server instance...","info"),(await window.api.stopServer()).success&&(o.isServerRunning=!1,this.log("Server stopped.","info"),this.setStatus("READY","blue"),e.btn.stop.classList.replace("flex","hidden"),e.btn.run.classList.replace("hidden","flex"),e.btn.consoleStop.classList.replace("flex","hidden"),e.btn.select.disabled=!1,e.btn.select.classList.remove("opacity-50","cursor-not-allowed"))},log(n,t="info"){const i=document.createElement("div");i.className="flex gap-2 animate-fade-in text-[11px]";const r=new Date().toLocaleTimeString("en-US",{hour12:!1});let s="text-zinc-400";t==="success"&&(s="text-emerald-400"),t==="error"&&(s="text-red-400"),i.innerHTML=`<span class="text-zinc-600 shrink-0 select-none font-mono">[${r}]</span><span class="${s} font-mono">${n}</span>`,e.console.body.appendChild(i),(t==="error"||t==="success")&&o.isConsoleCollapsed&&this.toggleConsole(),e.console.body.scrollTo({top:e.console.body.scrollHeight,behavior:"smooth"})},setStatus(n,t){const i={blue:"text-blue-400",green:"text-emerald-400",red:"text-red-400",yellow:"text-yellow-400"};e.console.status.textContent=n,e.console.status.className=`text-[10px] font-medium ${i[t]||"text-zinc-600"}`}};document.addEventListener("DOMContentLoaded",()=>a.init());
